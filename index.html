<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LunX Studio V7.1 - Mobil Uyumlu (KÄ±rmÄ±zÄ± Tema)</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <style>
        /* ======================================================= */
        /* ROBLOX STUDIO LIGHT THEME & LAYOUT */
        /* ======================================================= */
        :root {
            --bg-app: #f2f4f5;
            --bg-ribbon: #ffffff;
            --bg-panel: #ffffff;
            --border-color: #dcdcdc;
            --text-main: #333333;
            /* ğŸ”´ KIRMIZI TEMA GÃœNCELLEMESÄ° */
            --accent-blue: #ff3333; 
            --accent-hover: #ffe5e5; 
            --selection-bg: #ffeef2;
            --toolbar-height: 100px;
        }

        * { 
            box-sizing: border-box; 
            /* user-select: none; KaldÄ±rÄ±ldÄ±. Mobil uyum iÃ§in kaydÄ±rmayÄ± engellememek Ã¶nemli. */
            font-family: 'Segoe UI', Tahoma, sans-serif; 
        }
        
        body { 
            margin: 0; 
            overflow: hidden; /* TaÅŸmayÄ± engelle */
            background: var(--bg-app); 
            color: var(--text-main); 
            height: 100vh; 
            width: 100vw; /* Tam ekran geniÅŸliÄŸi */
            display: flex; 
            flex-direction: column; 
        }

        /* Full Screen Containers */
        .full-screen { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 9000; 
            background: var(--bg-app); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            overflow: auto; /* KÃ¼Ã§Ã¼k ekranlarda iÃ§erik sÄ±ÄŸmazsa kaydÄ±rÄ±lsÄ±n */
        }

        /* AUTH SCREEN */
        #auth-screen { background: #fff; }
        .auth-box { 
            width: 90%; 
            max-width: 350px; /* Maksimum geniÅŸlik ile masaÃ¼stÃ¼ gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ koru */
            padding: 30px; 
            background: #fff; 
            border: 1px solid #eee; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
            text-align: center; 
        }
        input { 
            width: 100%; 
            padding: 10px; 
            margin: 8px 0; 
            background: #f9f9f9; 
            border: 1px solid #ddd; 
            color: var(--text-main); 
            outline: none; 
            border-radius: 4px; 
        }
        button { 
            width: 100%; /* ButonlarÄ± tam geniÅŸlik yap */
            padding: 10px; 
            background: var(--accent-blue); 
            border: none; 
            color: white; 
            cursor: pointer; 
            font-weight: bold; 
            transition: 0.2s; 
            border-radius: 4px; 
            margin-top: 10px;
        }
        button:hover { background: #cc0000; } /* KIRMIZI HOVER */
        .auth-toggle { font-size: 12px; margin-top: 15px; cursor: pointer; color: var(--accent-blue); }

        /* START SCREEN */
        #start-screen { 
            display: none; 
            flex-direction: row; 
            flex: 1; /* Alana yayÄ±lsÄ±n */
        }
        #start-sidebar { 
            width: 250px; 
            background: #ffffff; 
            border-right: 1px solid var(--border-color); 
            padding: 20px; 
            /* Mobil iÃ§in gizle */
        }
        .start-btn-side { width: auto; margin: 5px 0; }
        .template-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
            gap: 20px; 
            padding: 40px; 
        }
        .template-card { 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            cursor: pointer; 
            transition: 0.2s; 
        }
        .template-card:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
            border-color: var(--accent-blue); 
        }
        .template-img { 
            height: 120px; 
            background: #ddd; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #888; 
            font-size: 40px; 
        }
        .template-name { 
            padding: 10px; 
            font-weight: bold; 
            font-size: 14px; 
            text-align: center; 
        }
        
        /* MOBÄ°L UYUM Ä°Ã‡Ä°N @MEDIA SORGUSU */
        @media (max-width: 768px) {
            #start-sidebar { display: none; } /* Mobil iÃ§in yan menÃ¼yÃ¼ gizle */
            .template-grid { padding: 20px; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
            .auth-box { margin: 20px; }
            
            /* Studio UI Mobil DÃ¼zenleme */
            /* #right-panel { width: 100%; border-left: none; } -> KaldÄ±rÄ±ldÄ±/DÃ¼zeltildi */
            /* #main-layout { flex-direction: column; } -> KaldÄ±rÄ±ldÄ±/DÃ¼zeltildi */
            #ribbon-bar { height: 75px; /* Daha kÄ±sa ribbon */ }
            .section-label { display: none; } /* Mobil ribbon'da etiketleri gizle */
            .ribbon-text { font-size: 10px; }
            .ribbon-icon { font-size: 18px; }
        }


        /* STUDIO UI */
        #studio-interface { display: none; height: 100vh; }
        #ribbon-bar { 
            height: var(--toolbar-height); 
            background: var(--bg-ribbon); 
            border-bottom: 1px solid var(--border-color); 
            display: flex; 
            align-items: center; /* ButonlarÄ± dikeyde ortala */
            padding: 5px;
            overflow-x: auto; /* YENÄ°: Yatay kaydÄ±rma */
            overflow-y: hidden;
            white-space: nowrap; /* Ä°Ã§eriÄŸin tek satÄ±rda kalmasÄ±nÄ± saÄŸla */
        }
        #ribbon-bar::-webkit-scrollbar { display: none; } /* KaydÄ±rma Ã§ubuÄŸunu gizle */
        
        .tool-section { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            border-right: 1px solid #ddd; 
            padding: 5px 15px; 
            gap: 2px; 
            height: 100%;
        }
        .section-label { font-size: 10px; color: #888; margin-top: auto; }
        
        .ribbon-tab-content { 
            display: flex; 
            gap: 10px; 
            align-items: center; 
            height: 100%;
            padding-bottom: 5px;
        }

        .ribbon-btn {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: transparent; border: 1px solid transparent; border-radius: 3px;
            padding: 5px; cursor: pointer; min-width: 40px; height: 60px; color: #333;
            transition: background 0.1s;
            flex-shrink: 0; /* ButonlarÄ±n sÄ±kÄ±ÅŸmasÄ±nÄ± engelle */
        }
        .ribbon-btn:hover { background: var(--accent-hover); border-color: #cce8ff; }
        .ribbon-btn.active { background: var(--accent-hover); border-color: var(--accent-blue); }
        .ribbon-icon { font-size: 20px; margin-bottom: 4px; }
        .ribbon-text { font-size: 11px; }

        /* Main Workspace */
        #main-layout { 
            display: flex; 
            flex: 1; 
            overflow: hidden; 
            width: 100%; 
            flex-direction: row; /* VarsayÄ±lan: Soldan saÄŸa sÄ±rala (Toolbox | Viewport | Right Panel) */
        }
        
        /* ğŸ’¡ YENÄ°: Right Panel Sola GeÃ§tiÄŸinde */
        #main-layout.panel-left {
            flex-direction: row-reverse; /* SÄ±ralamayÄ± tersine Ã§evir (Right Panel | Viewport | Toolbox) */
        }


        /* TOOLBOX PANEL STYLES */
        #toolbox-panel { 
            width: 0; 
            min-width: 0; 
            background: var(--bg-panel); 
            border-right: 1px solid var(--border-color); 
            transition: all 0.2s ease-in-out; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column;
            z-index: 10;
        }
        #toolbox-panel.open {
            width: 250px;
            min-width: 250px;
        }

        @media (max-width: 768px) {
            #toolbox-panel.open {
                position: absolute;
                left: 0;
                top: 75px; /* Ribbon yÃ¼ksekliÄŸi */
                bottom: 0;
                width: 70%;
                min-width: 70%;
                max-width: 250px;
            }
        }

        .toolbox-search-bar { padding: 10px; border-bottom: 1px solid var(--border-color); }
        .toolbox-search-bar input { width: 100%; padding: 8px; font-size: 12px; }
        #toolbox-content { flex: 1; overflow-y: auto; padding: 10px; }
        .toolbox-item { 
            display: flex; 
            align-items: center; 
            padding: 8px; 
            margin-bottom: 5px; 
            background: #f9f9f9; 
            border: 1px solid #eee; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 13px;
        }
        .toolbox-item:hover { background: var(--accent-hover); border-color: var(--accent-blue); }
        .toolbox-icon { font-size: 16px; margin-right: 10px; }
        
        /* VIEWPORT */
        #viewport-container { 
            flex: 1; 
            position: relative; 
            background: #99ccff; 
            min-height: 200px; /* Mobil iÃ§in minimum yÃ¼kseklik */
        }
        #viewport canvas { width: 100% !important; height: 100% !important; display: block; }
        
        /* Right Panel */
        #right-panel { 
            width: 300px; 
            display: flex; 
            flex-direction: column; 
            border-left: 1px solid var(--border-color); /* VarsayÄ±lan: SaÄŸ tarafta olduÄŸu iÃ§in sol kenarlÄ±k var */
            background: var(--bg-panel);
            flex-shrink: 0; /* SÄ±kÄ±ÅŸmasÄ±nÄ± engelle */
        }
        
        /* ğŸ’¡ YENÄ°: Right Panel Sola GeÃ§tiÄŸinde Stil GÃ¼ncellemesi */
        #main-layout.panel-left #right-panel {
            border-left: none; /* Sol kenarlÄ±ÄŸÄ± kaldÄ±r */
            border-right: 1px solid var(--border-color); /* SaÄŸ kenarlÄ±k ekle */
        }

        .panel-header { padding: 5px 10px; background: #f0f0f0; border-bottom: 1px solid #ddd; font-weight: bold; font-size: 12px; color: #555; }
        #explorer, #properties { flex: 1; overflow-y: auto; background: white; padding: 5px; font-size: 13px; }
        #properties { min-height: 150px; border-top: 1px solid var(--border-color); }
        
        /* Script Editor */
        #script-editor { 
            position: absolute; 
            top: var(--toolbar-height); 
            left: 0; 
            right: 300px; 
            bottom: 0; 
            background: #282c34; 
            z-index: 50; 
            display: none; 
            flex-direction: column; 
        }

        @media (max-width: 768px) {
            #script-editor {
                top: 75px;
                right: 0;
            }
        }
        
        #code-area { 
            flex: 1; 
            background: #282c34; 
            color: #abb2bf; 
            padding: 15px; 
            font-family: 'Consolas', monospace; 
            font-size: 14px; 
            resize: none; 
            outline: none; 
        }

    </style>
</head>
<body>

    <div id="auth-screen" class="full-screen">
        <div class="auth-box">
            <h2 style="color: var(--accent-blue);" id="auth-title">GiriÅŸ Yap</h2>
            <div id="auth-error" style="color:red; font-size:12px; margin-bottom:10px;"></div>
            <input type="email" id="auth-email" placeholder="E-posta">
            <input type="password" id="auth-pass" placeholder="Åifre">
            <button id="auth-submit-btn" onclick="LunX.auth.submit()">GÄ°RÄ°Å</button>
            <div class="auth-toggle" onclick="LunX.auth.toggleMode()">HesabÄ±n yok mu? KayÄ±t Ol</div>
        </div>
    </div>

    <div id="start-screen">
        <div id="start-sidebar">
            <h2 style="color:var(--accent-blue); margin:0 0 20px 0;">LunX Studio</h2>
            <div style="font-size:14px; color:#555; margin-bottom:20px;">HoÅŸ Geldin, <span id="username-display" style="font-weight:bold;">KullanÄ±cÄ±</span></div>
            <button class="start-btn-side active" onclick="alert('Yeni proje ekranÄ± aÃ§Ä±ldÄ±.')">Yeni</button>
            <button class="start-btn-side" onclick="LunX.auth.logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
        </div>
        <div style="flex:1; overflow-y:auto;">
            <div class="template-grid">
                <div class="template-card" onclick="LunX.manager.startStudio('baseplate')">
                    <div class="template-img">â¬œ</div><div class="template-name">Baseplate</div>
                </div>
                <div class="template-card" onclick="LunX.manager.startStudio('flat')">
                    <div class="template-img">ğŸŸ©</div><div class="template-name">Flat Terrain</div>
                </div>
                <div class="template-card" onclick="LunX.manager.startStudio('village')">
                    <div class="template-img">ğŸ¡</div><div class="template-name">Village</div>
                </div>
            </div>
        </div>
    </div>

    <div id="studio-interface">
        <div id="ribbon-bar">
            <div class="tool-section">
                <div class="ribbon-tab-content">
                    <div class="ribbon-btn" onclick="LunX.manager.exitStudio()">
                        <div class="ribbon-icon">ğŸ </div><div class="ribbon-text">Home</div>
                    </div>
                </div>
                <div class="section-label">File</div>
            </div>
            <div class="tool-section">
                <div class="ribbon-tab-content">
                    <div class="ribbon-btn active" id="tool-select" onclick="LunX.tools.setMode('select')">
                        <div class="ribbon-icon">ğŸ‘†</div><div class="ribbon-text">SeÃ§</div>
                    </div>
                    <div class="ribbon-btn" id="tool-translate" onclick="LunX.tools.setMode('translate')">
                        <div class="ribbon-icon">â†”ï¸</div><div class="ribbon-text">TaÅŸÄ±</div>
                    </div>
                    <div class="ribbon-btn" id="tool-scale" onclick="LunX.tools.setMode('scale')">
                        <div class="ribbon-icon">â¤¢</div><div class="ribbon-text">Boyut</div>
                    </div>
                    <div class="ribbon-btn" id="tool-rotate" onclick="LunX.tools.setMode('rotate')">
                        <div class="ribbon-icon">ğŸ”„</div><div class="ribbon-text">Ã‡evir</div>
                    </div>
                </div>
                <div class="section-label">AraÃ§lar</div>
            </div>

            <div class="tool-section">
                <div class="ribbon-tab-content">
                    <div class="ribbon-btn" onclick="LunX.tools.group()">
                        <div class="ribbon-icon">ğŸ”—</div><div class="ribbon-text">Grup</div>
                    </div>
                    <div class="ribbon-btn" onclick="LunX.tools.ungroup()">
                        <div class="ribbon-icon">âŒ</div><div class="ribbon-text">Ã‡Ã¶z</div>
                    </div>
                </div>
                <div class="section-label">Grup</div>
            </div>
            
             <div class="tool-section">
                <div class="ribbon-tab-content">
                    <div class="ribbon-btn" onclick="LunX.tools.undo()">
                        <div class="ribbon-icon">â†©ï¸</div><div class="ribbon-text">Geri Al</div>
                    </div>
                    <div class="ribbon-btn" onclick="LunX.tools.redo()">
                        <div class="ribbon-icon">â†ªï¸</div><div class="ribbon-text">Yinele</div>
                    </div>
                </div>
                <div class="section-label">GeÃ§miÅŸ</div>
            </div>
            
            <div class="tool-section">
                <div class="ribbon-tab-content">
                    <div class="ribbon-btn" onclick="LunX.world.addPart('box')">
                        <div class="ribbon-icon">ğŸ“¦</div><div class="ribbon-text">Part</div>
                    </div>
                    <div class="ribbon-btn" onclick="LunX.world.addPart('sphere')">
                        <div class="ribbon-icon">âšª</div><div class="ribbon-text">Sphere</div>
                    </div>
                     <div class="ribbon-btn" onclick="LunX.world.addScript()">
                        <div class="ribbon-icon">ğŸ“œ</div><div class="ribbon-text">Script</div>
                    </div>
                </div>
                <div class="section-label">Ekle</div>
            </div>
            
            <div class="tool-section">
                <div class="ribbon-tab-content">
                    <div class="ribbon-btn" onclick="LunX.tools.toggleToolbox()">
                        <div class="ribbon-icon">ğŸ› ï¸</div><div class="ribbon-text">Toolbox</div>
                    </div>
                    <div class="ribbon-btn" onclick="LunX.ui.togglePanelSide()">
                        <div class="ribbon-icon">â¬…ï¸â¡ï¸</div><div class="ribbon-text">Panel YÃ¶nÃ¼</div>
                    </div>
                </div>
                <div class="section-label">ArayÃ¼z</div>
            </div>
