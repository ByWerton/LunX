<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Tabanlı 3D Stüdyo</title>
    <style>
        body { margin: 0; overflow: hidden; } /* Sayfada kenar boşluğu olmasın */
        canvas { display: block; }
        /* Kontrol Butonları için basit stil */
        #controls {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 10;
        }
        #controls button {
            padding: 10px;
            margin-right: 5px;
            cursor: pointer;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="controls">
        <button id="translate">Hareket Ettir</button>
        <button id="rotate">Döndür</button>
        <button id="scale">Büyüt/Küçült</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script src="https://threejs.org/examples/js/controls/TransformControls.js"></script>

    <script>
        // --- 1. Temel Kurulumlar ---
        let scene, camera, renderer, controls, transformControls;
        let activeCube; // Şu anda seçili olan küpümüz

        function init() {
            // Sahne
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB); // Mavi tonlarda gökyüzü (Light Sky Blue)
            
            // Işıklandırma (Güneş ve Bulutlar Hissi)
            const sunLight = new THREE.DirectionalLight(0xffffff, 1.0); // Güneş Işığı
            sunLight.position.set(5, 10, 5);
            scene.add(sunLight);

            const ambientLight = new THREE.AmbientLight(0x404040); // Ortam Işığı
            scene.add(ambientLight);

            // Kamera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(5, 5, 5);
            camera.lookAt(0, 0, 0);

            // Renderer (Görüntüleyici)
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true; // Gölge haritasını etkinleştir
            document.body.appendChild(renderer.domElement);

            // --- 2. Ortam ve Nesneler ---
            
            // Zemin (Kutu gibi Arka Plan)
            const floorGeometry = new THREE.PlaneGeometry(50, 50);
            const floorMaterial = new THREE.MeshLambertMaterial({ color: 0x556B2F }); // Koyu yeşil (Orman Hissi)
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2; // X ekseninde 90 derece döndür
            floor.position.y = 0;
            floor.receiveShadow = true;
            scene.add(floor);

            // Ana Küp (Roblox Bloğu)
            const cubeGeometry = new THREE.BoxGeometry(1, 1, 1);
            const cubeMaterial = new THREE.MeshStandardMaterial({ color: 0xff0000 }); // Parlak Kırmızı
            activeCube = new THREE.Mesh(cubeGeometry, cubeMaterial);
            activeCube.position.set(0, 0.5, 0); // Zeminin hemen üstüne
            activeCube.castShadow = true;
            scene.add(activeCube);

            // --- 3. Kontroller (Gezinme ve Düzenleme) ---

            // OrbitControls: Sahneyi gezmek (Kamera kontrolü)
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.listenToKeyEvents(window); // Klavye olaylarını dinle

            // TransformControls: Nesneyi düzenlemek (Roblox araçları)
            transformControls = new THREE.TransformControls(camera, renderer.domElement);
            transformControls.attach(activeCube); // Kontrolü küpe bağla
            scene.add(transformControls);

            // TransformControls kullanılırken kameranın dönmesini engelle
            transformControls.addEventListener('dragging-changed', function (event) {
                controls.enabled = !event.value;
            });
            
            // --- 4. Butonları Bağlama ---

            document.getElementById('translate').addEventListener('click', () => {
                transformControls.setMode('translate');
            });
            document.getElementById('rotate').addEventListener('click', () => {
                transformControls.setMode('rotate');
            });
            document.getElementById('scale').addEventListener('click', () => {
                transformControls.setMode('scale');
            });

            // Pencere Boyutu Değiştiğinde
            window.addEventListener('resize', onWindowResize, false);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // --- 5. Animasyon ve Oyun Döngüsü ---
        function animate() {
            requestAnimationFrame(animate);

            controls.update(); // Orbit kontrollerini güncelle
            
            renderer.render(scene, camera);
        }

        init(); // Uygulamayı Başlat
        animate(); // Döngüyü Başlat
    </script>
</body>
</html>
