<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LunX Profesyonel C++ Scripting Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Modern ve Profesyonel TasarÄ±m - Koyu Tema */
        body { font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; background-color: #1e293b; color: #f8fafc; }
        .studio-container { background-color: #0f172a; border: 1px solid #334155; }
        .editor-container { background-color: #1a1a1a; color: #00ff00; font-family: 'Consolas', 'Courier New', monospace; font-size: 0.85rem; }
        .output-container { background-color: #0b111e; color: #cbd5e1; font-family: 'Consolas', 'Courier New', monospace; font-size: 0.8rem; height: 300px; }
        textarea { resize: none; }
        .log-error { color: #f87171; font-weight: bold; }
        .log-success { color: #34d399; font-weight: bold; }
        .log-system { color: #60a5fa; }
        .log-luau { color: #ffeb3b; } /* Luau sarÄ±sÄ± */
    </style>
</head>
<body>

    <div class="p-4 sm:p-8 max-w-6xl mx-auto studio-container rounded-xl shadow-2xl mt-4">
        <h1 class="text-3xl font-extrabold text-blue-400 mb-2 border-b border-blue-400 pb-2">
            LUNX PROFESSIONAL ENGINE - SCRIPTING STUDIO (C++ Core)
        </h1>
        <p class="text-gray-400 mb-6 text-sm">C++ Motoru, ModÃ¼ler Sistemler ve Luau Betik Dili entegrasyonu.</p>

        <!-- Luau Kod EditÃ¶rÃ¼ -->
        <div class="mb-6">
            <label for="luau-code" class="block text-sm font-semibold text-gray-300 mb-2">Luau BetiÄŸi</label>
            <textarea id="luau-code" rows="12" class="editor-container w-full p-4 rounded-lg shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Motorunuz iÃ§in Luau kodunu buraya yazÄ±n.">
-- Luau Scripting: Motor Ã§ekirdeÄŸini kontrol edin.
-- Luau betikleri C++ 'EngineCore' iÃ§inde Ã§alÄ±ÅŸÄ±r.

-- Ã–rnek: Basit bir mesaj yazdÄ±rma
print("Luau betiÄŸi motor tarafÄ±ndan baÅŸarÄ±yla Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±!")

-- Ã–rnek: Motor API'sÄ±nÄ± Ã§aÄŸÄ±rma simÃ¼lasyonu
-- LunX.World:CreateInstance("Block")
-- LunX.Assets:LoadTexture("Roblox_Texture_001")
            </textarea>
        </div>

        <!-- Kontrol Paneli -->
        <div class="flex flex-wrap gap-4 mb-6">
            <button id="run-button" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-6 rounded-lg shadow-xl transition duration-150 ease-in-out transform hover:scale-[1.02] active:scale-95">
                â–¶ï¸ BetiÄŸi Ã‡alÄ±ÅŸtÄ±r
            </button>
            <button id="init-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-xl transition duration-150 ease-in-out transform hover:scale-[1.02] active:scale-95">
                âš™ï¸ Motoru BaÅŸlat (TÃ¼m Sistemleri Init Et)
            </button>
            <button id="clear-button" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-xl transition duration-150 ease-in-out">
                ğŸ—‘ï¸ Konsolu Temizle
            </button>
        </div>
        
        <!-- Konsol Ã‡Ä±ktÄ±sÄ± -->
        <div class="mb-4">
            <label class="block text-sm font-semibold text-gray-300 mb-2">Motor Konsolu (C++ Sistem Ã‡Ä±ktÄ±larÄ±)</label>
            <pre id="output-log" class="output-container w-full p-4 rounded-lg overflow-y-auto border border-gray-700 shadow-lg"></pre>
        </div>
    </div>

    <script>
        const outputLog = document.getElementById('output-log');
        const codeEditor = document.getElementById('luau-code');
        const runButton = document.getElementById('run-button');
        const initButton = document.getElementById('init-button');
        const clearButton = document.getElementById('clear-button');

        // C++ tarafÄ±ndan Ã§aÄŸrÄ±lan JavaScript fonksiyonu
        window.JS_LogOutput = function(message) {
            const now = new Date().toLocaleTimeString();
            let className = 'log-system';

            if (message.includes('HATA') || message.includes('ERROR')) {
                className = 'log-error';
            } else if (message.includes('BAÅLATILIYOR') || message.includes('HAZIR')) {
                 className = 'log-success';
            } else if (message.includes('GameWorld') || message.includes('AssetLoader')) {
                 className = 'log-system';
            } else if (message.includes('Luau')) {
                 className = 'log-luau';
            }
            
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<span class="text-gray-500">[${now}]</span> <span class="${className}">${message.replace(/\n/g, '<br>')}</span>`;
            outputLog.appendChild(logEntry);
            outputLog.scrollTop = outputLog.scrollHeight; 
        };

        // Wasm ModÃ¼lÃ¼nÃ¼n YÃ¼klenmesi
        var Module = {
            onRuntimeInitialized: function() {
                JS_LogOutput("<span class='log-system'>Wasm ModÃ¼lÃ¼ BaÅŸarÄ±yla YÃ¼klendi. C++ ile baÄŸlantÄ± kuruldu.</span>");
                // Motoru otomatik olarak baÅŸlat
                try {
                    Module._InitializeLunXStudio(); 
                } catch (e) {
                    JS_LogOutput(`[WASM HATA]: Motor baÅŸlatma giriÅŸimi baÅŸarÄ±sÄ±z. ${e}`);
                }
            },
            // Geleneksel C++ Ã§Ä±ktÄ±larÄ±nÄ± (std::cout) yakalama simÃ¼lasyonu
            print: function(text) { JS_LogOutput(`[C++ STDIO]: ${text}`); },
            printErr: function(text) { JS_LogOutput(`[C++ STDERR]: ${text}`); }
        };

        // --- Olay Dinleyicileri ---
        runButton.addEventListener('click', function() {
            const luauCode = codeEditor.value;
            if (typeof Module._RunScript === 'function') {
                runButton.disabled = true;
                runButton.textContent = "âš™ï¸ Ã‡alÄ±ÅŸtÄ±rÄ±lÄ±yor...";
                
                // JS'ten C++'a string gÃ¶nderme
                const codePtr = Module.allocateUTF8(luauCode);
                Module._RunScript(codePtr);
                Module._free(codePtr); 
                
                runButton.disabled = false;
                runButton.textContent = "â–¶ï¸ BetiÄŸi Ã‡alÄ±ÅŸtÄ±r";
            } else {
                JS_LogOutput("[HATA]: Wasm Motor fonksiyonu (_RunScript) henÃ¼z yÃ¼klenmedi. LÃ¼tfen Motoru BaÅŸlatÄ±n.");
            }
        });

        initButton.addEventListener('click', function() {
            if (typeof Module._InitializeLunXStudio === 'function') {
                outputLog.innerHTML = '';
                Module._InitializeLunXStudio();
            } else {
                JS_LogOutput("[HATA]: Wasm ModÃ¼lÃ¼ YÃ¼klenmedi. SayfayÄ± Yenileyin.");
            }
        });

        clearButton.addEventListener('click', function() {
            outputLog.innerHTML = '';
            JS_LogOutput("Konsol temizlendi.");
        });

        // Wasm JavaScript Glue kodunu yÃ¼kle
        const script = document.createElement('script');
        script.src = 'motor_core.js'; 
        document.body.appendChild(script);

        // Emscripten dosya yolunu belirtme (Wasm dosyasÄ±nÄ±n doÄŸru yÃ¼klenmesi iÃ§in kritik)
        Module.locateFile = function(path, prefix) {
            return path; 
        }
    </script>
</body>
</html>

