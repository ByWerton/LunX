            // 4. 3D EDITOR CORE
            editor: {
                init3D: () => {
                    const container = document.getElementById('viewport');
                    
                    // Renderer'ı tekrar başlatmadan önce eskisini temizle
                    if (LunX.renderer && LunX.renderer.domElement.parentNode) {
                        LunX.renderer.dispose();
                        container.removeChild(LunX.renderer.domElement);
                    }
                    
                    LunX.scene = new THREE.Scene();
                    // ... (Diğer init3D kodları aynı kalsın) ...
                    
                    LunX.camera = new THREE.PerspectiveCamera(60, container.clientWidth/container.clientHeight, 0.1, 1000);
                    LunX.camera.position.set(10, 10, 10);
                    LunX.camera.lookAt(0,0,0); // Kamera başlangıç pozisyonunu ayarla
                    
                    // ... (Diğer init3D kodları aynı kalsın) ...
                    
                    LunX.editor.onResize(); 
                    container.addEventListener('mousedown', LunX.editor.onMouseDown);
                    LunX.editor.animate();
                },
                // ... (Diğer editor fonksiyonları) ...
            },
            
            // 5. WORLD & TEMPLATES
            world: {
                loadTemplate: (template) => {
                    // Tüm objeleri temizle
                    LunX.objects.forEach(obj => {
                        if (obj.isObject3D) {
                            LunX.scene.remove(obj);
                            if(obj.geometry) obj.geometry.dispose();
                            if(obj.material) {
                                if(Array.isArray(obj.material)) {
                                    obj.material.forEach(m => m.dispose());
                                } else if (typeof obj.material.dispose === 'function') {
                                    obj.material.dispose();
                                }
                            }
                        }
                    });
                    LunX.objects = [];
                    LunX.editor.select(null);
                    
                    // Kamerayı sıfırla
                    LunX.camera.position.set(10, 10, 10);
                    LunX.camera.lookAt(0,0,0);
                    LunX.controls.target.set(0,0,0);
                    LunX.controls.update();

                    LunX.scene.background = new THREE.Color(0x99ccff); 

                    // Temel Zemin (Baseplate)
                    const baseMat = LunX.ui.createMaterial("Plastic", 0x666666);
                    const baseplate = new THREE.Mesh(new THREE.BoxGeometry(100, 1, 100), baseMat);
                    baseplate.position.y = -0.5;
                    baseplate.receiveShadow = true;
                    baseplate.name = "Baseplate";
                    baseplate.userData = { 
                        locked: true, anchored: true, canCollide: true, isBase: true, material: "Plastic", 
                        scale: {x: 100, y: 1, z: 100},
                        rot: {x: 0, y: 0, z: 0} 
                    }; 
                    LunX.scene.add(baseplate);
                    LunX.objects.push(baseplate);
                    
                    // SpawnLocation
                    const spawnGeo = new THREE.BoxGeometry(4, 0.5, 4);
                    const spawnMat = new THREE.MeshStandardMaterial({ color: 0xaaaaaa, opacity: 0.5, transparent: true });
                    const spawn = new THREE.Mesh(spawnGeo, spawnMat);
                    spawn.position.set(0, 0.25, 0);
                    spawn.castShadow = true;
                    spawn.receiveShadow = true;
                    spawn.name = "SpawnLocation";
                    spawn.userData = { anchored: true, isSpawn: true, material: "Plastic", scale: {x: 4, y: 0.5, z: 4}, rot: {x: 0, y: 0, z: 0} };
                    LunX.scene.add(spawn);
                    LunX.objects.push(spawn);

                    if (template === 'flat') {
                        // Flat Terrain için Baseplate boyutunu ve materyalini değiştir
                        baseplate.geometry.dispose();
                        baseplate.geometry = new THREE.BoxGeometry(200, 1, 200);
                        baseplate.material.dispose(); // Eski materyali temizle
                        baseplate.material = LunX.ui.createMaterial("Grass", 0x4CAF50);
                        baseplate.userData.material = "Grass";
                        baseplate.userData.scale = {x: 200, y: 1, z: 200};
                        baseplate.geometry.attributes.position.needsUpdate = true;
                    } else if (template === 'village') {
                        // Dağlar
                        for(let i=0; i<3; i++) { // Dağ sayısını azalttım
                            const mountainGeo = new THREE.ConeGeometry(THREE.MathUtils.randFloat(10, 20), THREE.MathUtils.randFloat(15, 30), 16);
                            const mountainMat = LunX.ui.createMaterial("Rock", 0x8D6E63);
                            const mountain = new THREE.Mesh(mountainGeo, mountainMat);
                            mountain.position.set(THREE.MathUtils.randFloat(-40, 40), mountain.geometry.parameters.height/2 - 0.5, THREE.MathUtils.randFloat(-40, 40));
                            mountain.receiveShadow = true;
                            mountain.castShadow = true;
                            mountain.name = "Mountain" + (i+1);
                            mountain.userData = { 
                                anchored: true, canCollide: true, material: "Rock", 
                                scale: {x: 1, y: 1, z: 1},
                                rot: {x: 0, y: 0, z: 0} 
                            };
                            LunX.scene.add(mountain);
                            LunX.objects.push(mountain);
                        }
                        
                        // Basit Ev
                        const houseGroup = new THREE.Group();
                        houseGroup.name = "SimpleHouse";
                        houseGroup.position.set(10, 0, -10); // Konumunu zemine sıfırla
                        houseGroup.userData = { anchored: true, isGroup: true, scale: {x: 1, y: 1, z: 1}, rot: {x: 0, y: 0, z: 0} }; 
                        
                        const wall = new THREE.Mesh(new THREE.BoxGeometry(5, 5, 5), LunX.ui.createMaterial("Wood", 0xFFD700));
                        wall.position.y = 2.5; // Kendi içinde yukarı taşı
                        wall.castShadow = true;
                        wall.name = "Wall";
                        wall.userData = { anchored: true, canCollide: true, material: "Wood", scale: {x: 5, y: 5, z: 5}, rot: {x: 0, y: 0, z: 0} };
                        houseGroup.add(wall);

                        const roof = new THREE.Mesh(new THREE.ConeGeometry(4, 3, 4), LunX.ui.createMaterial("Plastic", 0x8B0000));
                        roof.position.y = 5 + (3/2) - 0.5; // Duvarın üstüne koy
                        roof.rotation.y = Math.PI/4;
                        roof.castShadow = true;
                        roof.name = "Roof";
                        roof.userData = { anchored: true, canCollide: true, material: "Plastic", scale: {x: 1, y: 1, z: 1}, rot: {x: 0.785, y: 0.785, z: 0} };
                        houseGroup.add(roof);
                        
                        LunX.scene.add(houseGroup);
                        LunX.objects.push(houseGroup);
                    }


                    LunX.tools.saveState();
                    LunX.ui.refreshExplorer();
                },
                
                // ... (Diğer world fonksiyonları) ...
            },
